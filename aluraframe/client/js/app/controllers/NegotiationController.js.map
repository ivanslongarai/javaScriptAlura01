{"version":3,"sources":["../../app-es6/controllers/NegotiationController.js"],"names":["NegotiationList","Message","NegotiationsView","MessageView","NegotiationService","DateHelper","Bind","Negotiation","NegotiationController","$","document","querySelector","bind","_inputDate","_inputAmount","_inputPrice","_negotiationList","_message","_service","_init","listAll","then","negotiations","forEach","add","negotiation","catch","console","log","err","text","setInterval","importNegotiations","event","preventDefault","_createNegotiation","message","_reset","textToDate","value","parseInt","parseFloat","focus","clearList","setEmpty"],"mappings":"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","file":"NegotiationController.js","sourcesContent":["import {NegotiationList} from \"../models/NegotiationList\";\r\nimport {Message} from \"../models/Message\";\r\nimport {NegotiationsView} from \"../views/NegotiationsView\";\r\nimport {MessageView} from \"../views/MessageView\";\r\nimport {NegotiationService} from \"../services/NegotiationService\";\r\nimport {DateHelper} from \"../helpers/DateHelper\";\r\nimport {Bind} from \"../helpers/Bind\";\r\nimport {Negotiation} from \"../models/Negotiation\";\r\n\r\nexport class NegotiationController {\r\n\r\n    constructor() {\r\n        const $ = document.querySelector.bind(document);\r\n        this._inputDate = $(\"#date\");\r\n        this._inputAmount = $(\"#amount\");\r\n        this._inputPrice = $(\"#price\");\r\n        this._negotiationList = new Bind(new NegotiationList(), new NegotiationsView($(\"#negotiations-view\")), 'add', 'setEmpty');\r\n        this._message = new Bind(new Message(), new MessageView($(\"#message-view\")), 'text');\r\n        this._service = new NegotiationService();\r\n        this._init();\r\n    }\r\n\r\n    _init() {\r\n        this._service\r\n            .listAll()\r\n            .then(negotiations =>\r\n                negotiations.forEach(negotiation =>\r\n                    this._negotiationList.add(negotiation)))\r\n            .catch(err => {\r\n                console.log(err);\r\n                this._message.text = err;\r\n            });\r\n        setInterval(() => {\r\n            this.importNegotiations();\r\n        }, 3000);\r\n    };\r\n\r\n    add(event) {\r\n        event.preventDefault();\r\n        let negotiation = this._createNegotiation();\r\n        this._service\r\n            .add(negotiation)\r\n            .then(message => {\r\n                this._negotiationList.add(negotiation);\r\n                this._message.text = message;\r\n                this._reset();\r\n            }).catch(err => this._message.text = err);\r\n    };\r\n\r\n    _createNegotiation() {\r\n        return new Negotiation(\r\n            DateHelper.textToDate(this._inputDate.value),\r\n            parseInt(this._inputAmount.value),\r\n            parseFloat(this._inputPrice.value),\r\n        );\r\n    }\r\n\r\n    _reset() {\r\n        this._inputDate.value = \"\";\r\n        this._inputAmount.value = 1;\r\n        this._inputPrice.value = 0;\r\n        this._inputDate.focus();\r\n    }\r\n\r\n    clearList() {\r\n        this._service\r\n            .clearList()\r\n            .then(message => {\r\n                this._message.text = message;\r\n                this._negotiationList.setEmpty()\r\n            })\r\n            .catch(err => this._message.text = err);\r\n    }\r\n\r\n    importNegotiations() {\r\n        this._service\r\n            .importNegotiations(this._negotiationList.negotiations)\r\n            .then(negotiations => {\r\n                negotiations.forEach(negotiation => {\r\n                    this._negotiationList.add(negotiation);\r\n                    this._message.text = \"Negociações importadas com sucesso\";\r\n                })\r\n            });\r\n    }\r\n}"]}